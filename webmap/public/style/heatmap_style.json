{
  "version": 8,
  "name": "Empty Style",
  "sources": {
    "pneuma": {
      "type": "vector",
      "promoteId": "id",
      "lineMetrics": true,
      "tilesDev": ["http://localhost/trajectories/{z}/{x}/{y}"],
      "tilesProd": ["https://pneuma-dev.epfl.ch/tiles/trajectories/{z}/{x}/{y}"],
      "tiles": ["https://pneuma-dev.epfl.ch/tiles/trajectories/{z}/{x}/{y}"]
    },
    "points": {
      "type": "vector",
      "promoteId": "id",
      "tilesDev": ["http://localhost/points/{z}/{x}/{y}"],
      "tilesProd": ["https://pneuma-dev.epfl.ch/tiles/points/{z}/{x}/{y}"],
      "tiles": ["https://pneuma-dev.epfl.ch/tiles/points/{z}/{x}/{y}"]
    },
    "trajectories_points": {
      "type": "vector",
      "tilesProd": ["https://pneuma-dev.epfl.ch/tiles/get_trajectories_points/{z}/{x}/{y}"],
      "tilesDev": ["http://localhost/get_trajectories_points/{z}/{x}/{y}"],
      "tiles": ["https://pneuma-dev.epfl.ch/tiles/get_trajectories_points/{z}/{x}/{y}"]
    },

    "heatmap": {
      "type": "vector",
      "tilesProd": ["https://pneuma-dev.epfl.ch/tiles/speed_hexmap/{z}/{x}/{y}"],
      "tilesDev": ["http://localhost/speed_hexmap/{z}/{x}/{y}"],
      "tiles": ["https://pneuma-dev.epfl.ch/tiles/speed_hexmap/{z}/{x}/{y}"],
      "maxzoom": 16
    },
    "background": {
      "tileSize": 256,
      "tiles": ["https://tile.osm.ch/osm-swiss-style/{z}/{x}/{y}.png"],
      "type": "raster"
    },
    "osm": {
      "type": "geojson",
      "data": "https://enacit4r-cdn.epfl.ch/pneuma/data_osm.geojson"
    }
  },
  "sprite": "https://enacit4r-cdn.epfl.ch/pneuma/sprites/sprite",
  "glyphs": "https://orangemug.github.io/font-glyphs/glyphs/{fontstack}/{range}.pbf",
  "layers": [
    {
      "id": "background",
      "type": "raster",
      "source": "background",
      "paint": {
        "raster-saturation": -0.9,
        "raster-brightness-min": 0.7
      }
    },
    {
      "id": "speed-heatmap",
      "type": "fill",
      "source": "heatmap",
      "source-layer": "speed_hexmap",
      "layout": {
        "visibility": "visible"
      },
      "paint": {
        "fill-opacity": 0.8,
        "fill-color": [
          "interpolate",
          ["linear"],
          ["get", "avg_speed"],
          0,
          "#440154",
          5,
          "#482878",
          10,
          "#3e4989",
          20,
          "#31688e",
          30,
          "#26828e",
          40,
          "#1f9e89",
          50,
          "#35b779",
          60,
          "#6ece58",
          70,
          "#b5de2b",
          80,
          "#fde725"
        ]
      }
    },
    {
      "id": "acceleration-heatmap",
      "type": "fill",
      "source": "heatmap",
      "source-layer": "speed_hexmap",
      "layout": {
        "visibility": "none"
      },
      "paint": {
        "fill-opacity": 0.8,
        "fill-color": [
          "interpolate",
          ["linear"],
          ["get", "avg_acceleration"],
          0,
          "#440154",
          0.3125,
          "#482878",
          0.625,
          "#3e4989",
          0.9375,
          "#31688e",
          1.25,
          "#26828e",
          1.5625,
          "#1f9e89",
          1.875,
          "#35b779",
          2.1875,
          "#6ece58",
          2.5,
          "#fde725"
        ]
      }
    },
    {
      "id": "density-heatmap",
      "type": "fill",
      "source": "heatmap",
      "source-layer": "speed_hexmap",
      "layout": {
        "visibility": "none"
      },
      "paint": {
        "fill-opacity": 0.8,
        "fill-color": [
          "interpolate",
          ["linear"],
          ["get", "density"],
          0,
          "#002051",
          10,
          "#2b446e",
          20,
          "#696970",
          30,
          "#948f78",
          40,
          "#caba6a",
          50,
          "#fdea45"
        ]
      }
    },
    {
      "id": "vehicles",
      "type": "line",
      "source": "pneuma",
      "source-layer": "trajectories",
      "layout": {
        "visibility": "none"
      },
      "paint": {
        "line-color": [
          "match",
          ["get", "vehicle_type"],
          "Taxi",
          "#ff8c00",
          "Bus",
          "#ff0000",
          "Heavy Vehicle",
          "#483d8b",
          "Medium Vehicle",
          "#32cd32",
          "Motorcycle",
          "#ff69b4",
          "Car",
          "#007cbf",
          "#000000"
        ],
        "line-width": ["case", ["boolean", ["feature-state", "hover"], false], 8, 2],
        "line-opacity": ["case", ["boolean", ["feature-state", "hover"], false], 1, 0.1]
      }
    },

    {
      "id": "positions",
      "type": "circle",
      "source": "trajectories_points",
      "source-layer": "get_trajectories_points",
      "layout": {
        "visibility": "none"
      },
      "paint": {
        "circle-color": [
          "interpolate",
          ["exponential", 1.2],
          ["get", "avg_speed"],
          0,
          "#a50026",
          10,
          "#d6352c",
          20,
          "#f37547",
          30,
          "#fdbe70",
          40,
          "#fdefa5",
          50,
          "#fcf5ab",
          60,
          "#006837",
          250,
          "#006837"
        ]
      }
    },
    {
      "id": "all_points",
      "type": "circle",
      "source": "points",
      "source-layer": "points",
      "layout": {
        "visibility": "none"
      },
      "paint": {
        "circle-color": [
          "interpolate",
          ["linear"],
          ["get", "speed"],
          0,
          "#a50026",
          10,
          "#d6352c",
          20,
          "#f37547",
          30,
          "#fdbe70",
          40,
          "#fdefa5",
          50,
          "#fcf5ab",
          60,
          "#006837"
        ],
        "circle-radius": ["case", ["boolean", ["feature-state", "hover"], false], 6, 2],
        "circle-opacity": ["case", ["boolean", ["feature-state", "hover"], false], 1, 0.0]
      }
    },
    {
      "id": "traffic_signals",
      "type": "symbol",
      "source": "osm",
      "minzoom": 16,
      "filter": ["==", ["get", "highway"], "traffic_signals"],
      "layout": {
        "icon-image": "Traffic_light-16",
        "icon-size": ["interpolate", ["exponential", 3], ["zoom"], 17, 1.2, 22, 8]
      }
    },
    {
      "id": "bus_stops",
      "type": "symbol",
      "source": "osm",
      "minzoom": 16,
      "filter": ["==", ["get", "highway"], "bus_stop"],
      "layout": {
        "icon-image": "Bus-stop-12",
        "icon-size": ["interpolate", ["exponential", 3], ["zoom"], 17, 1.2, 22, 8]
      }
    }
  ]
}
